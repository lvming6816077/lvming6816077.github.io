
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>HTTP2 Server Push 研究 | 吕小鸣前端博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1，HTTP2的新特性。关于HTTP2的新特性，读着可以参看我之前的文章，这里就不在多说了，本篇文章主要讲一下server push这个特性。 HTTPS与HTTP2的原理，搭建，性能测试对比 HTTP,HTTP2.0,SPDY,HTTPS你应该知道的一些事">
<meta name="keywords" content="http2">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTP2 Server Push 研究">
<meta property="og:url" content="http://www.nihaoshijie.com.cn/index.php/archives/651/index.html">
<meta property="og:site_name" content="吕小鸣前端博客">
<meta property="og:description" content="1，HTTP2的新特性。关于HTTP2的新特性，读着可以参看我之前的文章，这里就不在多说了，本篇文章主要讲一下server push这个特性。 HTTPS与HTTP2的原理，搭建，性能测试对比 HTTP,HTTP2.0,SPDY,HTTPS你应该知道的一些事">
<meta property="og:image" content="https://oc5n93kni.qnssl.com/7542543_SPDY-to-HTTP2-Upgrade-and-Nginx_thumb.jpg">
<meta property="og:updated_time" content="2017-04-27T12:56:19.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTTP2 Server Push 研究">
<meta name="twitter:description" content="1，HTTP2的新特性。关于HTTP2的新特性，读着可以参看我之前的文章，这里就不在多说了，本篇文章主要讲一下server push这个特性。 HTTPS与HTTP2的原理，搭建，性能测试对比 HTTP,HTTP2.0,SPDY,HTTPS你应该知道的一些事">
<meta name="twitter:image" content="https://oc5n93kni.qnssl.com/7542543_SPDY-to-HTTP2-Upgrade-and-Nginx_thumb.jpg">
  
    <link rel="alternative" href="/atom.xml" title="吕小鸣前端博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  



</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">吕小鸣前端博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">热爱前端，关注前端开发技术</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">主页</a>
        
          <a class="main-nav-link" href="/archives">文章归档</a>
        
          <a class="main-nav-link" href="/about">关于本站</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="www.nihaoshijie.com.cn">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-HTTP2-Server-Push-研究" class="article article-type-post" itemscope itemprop="blogPost">

  <div class="article-inner ">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    <div style="background-image:url(https://oc5n93kni.qnssl.com/7542543_SPDY-to-HTTP2-Upgrade-and-Nginx_thumb.jpg);" class="post-pic"></div>
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      HTTP2 Server Push 研究
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p></p><h2>1，HTTP2的新特性。</h2><br>关于HTTP2的新特性，读着可以参看我之前的文章，这里就不在多说了，本篇文章主要讲一下server push这个特性。<p></p>
<p><a href="http://km.oa.com/group/19674/articles/show/276552" target="_blank" rel="noopener noreferrer">HTTPS与HTTP2的原理，搭建，性能测试对比</a></p>
<p><a href="http://km.oa.com/articles/view/290595" target="_blank" rel="noopener noreferrer">HTTP,HTTP2.0,SPDY,HTTPS你应该知道的一些事</a><br><a id="more"></a></p>
<p></p><h2>2，Server Push是什么。</h2><br>简单来讲就是当用户的浏览器和服务器在建立链接后，服务器主动将一些资源推送给浏览器并缓存起来，这样当浏览器接下来请求这些资源时就直接从缓存中读取，不会在从服务器上拉了，提升了速率。举一个例子就是：<p></p>
<p>假如一个页面有3个资源文件<strong>index.html</strong>,<strong>index.css</strong>,<strong>index.js</strong>,当浏览器请求index.html的时候，服务器不仅返回index.html的内容，同时将index.css和index.js的内容push给浏览器，当浏览器下次请求这2两个文件时就可以直接从缓存中读取了。</p>
<p></p><h2></h2><p></p>
<p></p><h2>3，Server Push原理是什么。</h2><br>要想了解server push原理，首先要理解一些概念。我们知道HTTP2传输的格式并不像HTTP1使用文本来传输，而是启用了二进制帧(Frames)格式来传输，和server push相关的帧主要分成这几种类型：<p></p>
<ol><br>     <li>HEADERS frame(请求返回头帧):这种帧主要携带的http请求头信息，和HTTP1的header类似。</li><br>     <li>DATA frames(数据帧) :这种帧存放真正的数据content，用来传输。</li><br>     <li>PUSH_PROMISE frame(推送帧):这种帧是由server端发送给client的帧，用来表示server push的帧，这种帧是实现server push的主要帧类型。</li><br>     <li>RST_STREAM(取消推送帧):这种帧表示请求关闭帧，简单讲就是当client不想接受某些资源或者接受timeout时会向发送方发送此帧，和PUSH_PROMISE frame一起使用时表示拒绝或者关闭server push。</li><br></ol><br><span style="font-weight: bolder;">Note:</span>HTTP2.0相关的帧其实包括<a href="https://tools.ietf.org/html/rfc7540#section-11.2" target="_blank" rel="noopener noreferrer">10种帧</a>，正是因为底层数据格式的改变，才为HTTP2.0带来许多的特性，帧的引入不仅有利于压缩数据，也有利于数据的安全性和可靠传输性。<br><br><strong>了解了相关的帧类型，下面就是具体server push的实现过程了：</strong><br><ol><br>     <li>由多路复用我们可以知道HTTP2中对于同一个域名的请求会使用一条tcp链接而用不同的stream ID来区分各自的请求。</li><br>     <li>当client使用stream 1请求index.html时，server正常处理index.html的请求，并可以得知index.html页面还将要会请求index.css和index.js。</li><br>     <li>server使用stream 1发送PUSH_PROMISE frame给client告诉client我这边可以使用stream 2来推送index.js和stream 3来推送index.css资源。</li><br>     <li>server使用stream 1正常的发送HEADERS frame和DATA frames将index.html的内容返回给client。</li><br>     <li>client接收到PUSH_PROMISE frame得知stream 2和stream 3来接收推送资源。</li><br>     <li>server拿到index.css和index.js便会发送HEADERS frame和DATA frames将资源发送给client。</li><br>     <li>client拿到push的资源后会缓存起来当请求这个资源时会从直接从从缓存中读取。</li><br></ol><br>下图表示了整个流程：<br><br><a href="http://www.nihaoshijie.com.cn/wp-content/uploads/2016/11/屏幕快照-2016-11-27-19.07.58.png"><img class="alignnone size-full wp-image-656" src="http://www.nihaoshijie.com.cn/wp-content/uploads/2016/11/屏幕快照-2016-11-27-19.07.58.png" alt="%e5%b1%8f%e5%b9%95%e5%bf%ab%e7%85%a7-2016-11-27-19-07-58" width="2024" height="1448"></a><br><h2>4，Server Push怎么用。</h2><br>既然server push这么神奇，那么我们如何使用呢？怎么设置服务器push哪些文件呢？<br><br>首先并不是所有的服务器都支持server push，nginx目前还不支持这个特性，可以在nginx的官方博客上得到证实<a href="https://www.nginx.com/blog/http2-r7/" target="_blank" rel="noopener noreferrer">https://www.nginx.com/blog/http2-r7/</a>，但是Apache和nodejs都已经支持了server push这一个特性，需要说明一点的是server push这个特性是基于浏览器和服务器的，所以浏览器并没有提供相应的js api来让用户直接操作和控制push的内容，所以只能是通过header信息和server的配置来实现具体的push内容，本文主要以nodejs来说明具体如何使用server push这一特性。<br><br><strong>准备工作</strong>：下载<a href="https://github.com/molnarg/node-http2" target="_blank" rel="noopener noreferrer">nodejs http2</a>支持，本地启动nodejs服务。<br><br><strong>1. 首先我们使用nodejs搭建基本的server：</strong><br><div class="km_insert_code"><br><pre><code><span class="hljs-keyword">var</span> http2 = <span class="hljs-built_in">require</span>(<span class="hljs-string">‘http2’</span>);<br><br><span class="hljs-keyword">var</span> url=<span class="hljs-built_in">require</span>(<span class="hljs-string">‘url’</span>);<br><span class="hljs-keyword">var</span> fs=<span class="hljs-built_in">require</span>(<span class="hljs-string">‘fs’</span>);<br><span class="hljs-keyword">var</span> mine=<span class="hljs-built_in">require</span>(<span class="hljs-string">‘./mine’</span>).types;<br><span class="hljs-keyword">var</span> path=<span class="hljs-built_in">require</span>(<span class="hljs-string">‘path’</span>);<br><br><span class="hljs-keyword">var</span> server = http2.createServer({<br>  key: fs.readFileSync(<span class="hljs-string">‘./zs/localhost.key’</span>),<br>  cert: fs.readFileSync(<span class="hljs-string">‘./zs/localhost.crt’</span>)<br>}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">request, response</span>) </span>{<br>    <span class="hljs-keyword">var</span> pathname = url.parse(request.url).pathname;<br>    <span class="hljs-keyword">var</span> realPath = path.join(<span class="hljs-string">“my”</span>, pathname);    <span class="hljs-comment">//这里设置自己的文件名称;</span><br><br>    <span class="hljs-keyword">var</span> pushArray = [];<br>    <span class="hljs-keyword">var</span> ext = path.extname(realPath);<br>    ext = ext ? ext.slice(<span class="hljs-number">1</span>) : <span class="hljs-string">‘unknown’</span>;<br>    <span class="hljs-keyword">var</span> contentType = mine[ext] || <span class="hljs-string">“text/plain”</span>;<br><br>    <span class="hljs-keyword">if</span> (fs.existsSync(realPath)) {<br><br>        response.writeHead(<span class="hljs-number">200</span>, {<br>            <span class="hljs-string">‘Content-Type’</span>: contentType<br>        });<br><br>        response.write(fs.readFileSync(realPath,<span class="hljs-string">‘binary’</span>));<br><br>    } <span class="hljs-keyword">else</span> {<br>      response.writeHead(<span class="hljs-number">404</span>, {<br>          <span class="hljs-string">‘Content-Type’</span>: <span class="hljs-string">‘text/plain’</span><br>      });<br><br>      response.write(<span class="hljs-string">“This request URL “</span> + pathname + <span class="hljs-string">“ was not found on this server.”</span>);<br>      response.end();<br>    }<br><br>});<br><br>server.listen(<span class="hljs-number">443</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>() </span>{<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">‘listen on 443’</span>);<br>});</code></pre><br></div><br>这几行代码就是简单搭建一个nodejs http2服务，打开chrome，我们可以看到所有请求都走了http2，同时也可以验证多路复用的特性。<br><br><a href="http://www.nihaoshijie.com.cn/wp-content/uploads/2016/11/h21.png"><img class="alignnone size-full wp-image-657" src="http://www.nihaoshijie.com.cn/wp-content/uploads/2016/11/h21.png" alt="h21" width="1327" height="257"></a><br><br><strong>这里需要注意几点：</strong><br><ol><br>     <li>创建http2的nodejs服务必须时基于https的，因为现在主流的浏览器都要支持SSL/TLS的http2，证书和私钥可以自己通过<a href="https://www.openssl.org/" target="_blank" rel="noopener noreferrer">OPENSSL</a>生成。</li><br>     <li>node http2的相关api和正常的node httpserver相同，可以直接使用。</li><br></ol><br><span style="font-weight: bolder;">2. 设置我们的server push：</span><br><div class="km_insert_code"><br><pre><code><span class="hljs-keyword">var</span> pushItem = response.push(<span class="hljs-string">‘/css/bootstrap.min.css’</span>, {<br>       request: {<br>            accept: <span class="hljs-string">‘<em>/\</em>‘</span><br>       },<br>      response: {<br>            <span class="hljs-string">‘content-type’</span>: <span class="hljs-string">‘text/css’</span><br>     }<br>});<br>pushItem.end(fs.readFileSync(<span class="hljs-string">‘/css/bootstrap.min.css’</span>,<span class="hljs-string">‘binary’</span>));</code></pre><br></div><br>我们设置了bootstrap.min.css来通过server push到我们的浏览器,我们可以在浏览器中查看：<br><br><a href="http://www.nihaoshijie.com.cn/wp-content/uploads/2016/11/h22.png"><img class="alignnone size-full wp-image-658" src="http://www.nihaoshijie.com.cn/wp-content/uploads/2016/11/h22.png" alt="h22" width="1716" height="356"></a><br><br>可以看到，启动server push的资源timelime非常快，大大加速了css的获取时间。<br><br><strong>这里需要注意下面几点：</strong><br><ol><br>     <li>我们调用response.push(),就是相当于server发起了PUSH_PROMISE frame来告知浏览器bootstrap.min.css将会由server push来获取。</li><br>     <li>response.push()返回的对象时一个正常的ServerResponse,end(),writeHeader()等方法都可以正常调用。</li><br>     <li>这里一旦针对某个资源调用response.push()即发起PUSH_PROMISE frame后，要做好容错机制，因为浏览器在下次请求这个资源时会且只会等待这个server push回来的资源，这里要做好超时和容错即下面的代码：</li><br>     <li><br><div class="km_insert_code"><br><pre><code><span class="hljs-keyword">try</span> {<br>    pushItem.end(fs.readFileSync(<span class="hljs-string">‘my/css/bootstrap.min.css’</span>,<span class="hljs-string">‘binary’</span>));<br>    } <span class="hljs-keyword">catch</span>(e) {<br>       response.writeHead(<span class="hljs-number">404</span>, {<br>           <span class="hljs-string">‘Content-Type’</span>: <span class="hljs-string">‘text/plain’</span><br>       });<br>       response.end(<span class="hljs-string">‘request error’</span>);<br>}<br><br>pushItem.stream.on(<span class="hljs-string">‘error’</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{<br>    response.end(err.message);<br>});<br><br>pushItem.stream.on(<span class="hljs-string">‘finish’</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{<br>   <span class="hljs-built_in">console</span>.log(<span class="hljs-string">‘finish’</span>);<br>});</code></pre><br></div><br>上面的代码你可能会发现许多和正常nodejs的httpserver不一样的东西，那就是stream，其实整个http2都是以stream为单位，这里的stream其实可以理解成一个请求，更多的api可以参考：<a href="https://github.com/molnarg/node-http2/wiki/Public-API" target="_blank" rel="noopener noreferrer">node-http2</a>。</li><br>     <li>最后给大家推荐一个老外写的专门服务http2的node server有兴趣的可以尝试一下。<a href="https://gitlab.com/sebdeckers/http2server" target="_blank" rel="noopener noreferrer">https://gitlab.com/sebdeckers/http2server</a></li><br></ol><br><h2></h2><br><h2>5，Server Push相关问题。</h2><br><ol><br>     <li>我们知道现在我们web的资源一般都是放在CDN上的，那么CDN的优势和server push的优势有何区别呢，到底是哪个比较快呢？这个问题笔者也一直在研究，本文的相关demo都只能算做一个演示，具体的线上实践还在进行中。</li><br>     <li>由于HTTP2的一些新特性例如多路复用，server push等等都是基于同一个域名的，所以这可能会对我们之前对于HTTP1的一些优化措施例如(资源拆分域名，合并等等)不一定适用。</li><br>     <li>server push不仅可以用作拉取静态资源，我们的cgi请求即ajax请求同样可以使用server push来发送数据。</li><br>     <li>最完美的结果是CDN域名支持HTTP2,web server域名也同时支持HTTP2。</li><br></ol><br>&nbsp;<br><br>参考资料：<br><ol><br>     <li>HTTP2官方标准：<a href="https://tools.ietf.org/html/rfc7540" target="_blank" rel="noopener noreferrer">https://tools.ietf.org/html/rfc7540</a></li><br>     <li>维基百科：<a href="https://en.wikipedia.org/wiki/HTTP/2_Server_Push" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/HTTP/2_Server_Push</a></li><br></ol>
      
    </div>

    <footer class="article-footer">
      
        <a data-url="http://www.nihaoshijie.com.cn/index.php/archives/651/" data-id="cj27jybcf000gz39n4ejqrnhe" class="article-share-link" data-share="baidu" data-title="HTTP2 Server Push 研究">分享到</a>
      

      <a href="http://www.nihaoshijie.com.cn/index.php/archives/651/#ds-thread" class="article-comment-link"><span class="dot">•</span>
      <span class="view-count" id="indexphparchives651learnCount">0</span> 次浏览</a>
      <a href="http://www.nihaoshijie.com.cn/index.php/archives/651/#ds-thread" class="article-comment-link"><span class="dot">•</span>
      
        <span class="cloud-tie-join-count"><span class="join-count">0</span></span>
      
      条评论</a>
      
      <a href="/index.php/archives/651/" class="article-date-l">
  <time datetime="2016-11-27T12:40:27.000Z" itemprop="datePublished">2016-11-27</time>
</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http2/">http2</a></li></ul>

    </footer>
  </div>
  
    
  
</article>


  <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    <script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>
    <script>
    var cloudTieConfig = {
      url: document.location.href.replace('https','').replace('http',''),
      sourceId: "",
      productKey: "eb0b276c0f00410db0322e1a9a9b8bbc",
      target: "cloud-tie-wrapper"
    };
    var yunManualLoad = true;
    Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);
    </script>

</section>
      
      <aside id="sidebar">
  <div class="widget-wrap">
    
    <div class="widget info">

      <img class="avatar" src="https://avatars3.githubusercontent.com/u/7931760?v=3&s=460"/>
      <h3 class="nick-name">吕小鸣</h3>
      <p class="desc">实践过，才懂得</p>
      <div class="post-info">
        <div class="info-inner">
          <div class="info-num">28</div>
          <div class="info-name">文章</div>
        </div>
        <div class="info-inner">
          <div class="info-num">18</div>
          <div class="info-name">分类</div>
        </div>
        <div class="info-inner">
          <div class="info-num">29</div>
          <div class="info-name">标签</div>
        </div>
      </div>
      <div class="info-links">
        <a class="info-link github" href="https://github.com/lvming6816077" target="_blank" title="GitHub">
        <i class="github"></i>
          GitHub
        </a>
        <a class="info-link weibo" href="http://weibo.com/lvming6816077/home?wvr=5&topnav=1&mod=logo" target="_blank" title="GitHub">
        <i class="weibo"></i>
          WeiBo
        </a>
      </div>
    </div>
  </div>
  <div class="widget-wrap">
    
    <div class="widget">
      <img style="width:100%;" src="https://oc5n93kni.qnssl.com/qunmingp.jpg" />
    </div>
  </div>
  
    
  <div class="widget-wrap">
    
    <div class="widget">
    <h3 class="widget-title-l">近期文章</h3>
      <ul>
        
          <li class="recent-li">
            <a href="/index.php/archives/700/">吕小鸣博客搬家记Hexo</a>
          </li>
        
          <li class="recent-li">
            <a href="/index.php/archives/698/">HTTP2.0关于多路复用的研究</a>
          </li>
        
          <li class="recent-li">
            <a href="/index.php/archives/690/">移动web之滚动篇</a>
          </li>
        
          <li class="recent-li">
            <a href="/index.php/archives/667/">线条之美，玩转SVG线条动画</a>
          </li>
        
          <li class="recent-li">
            <a href="/index.php/archives/651/">HTTP2 Server Push 研究</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title-l">归档</h3>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">十月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">九月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">八月 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">七月 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">六月 2014</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    
    <div class="widget">
      <h3 class="widget-title-l">标签</h3>
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Angular/">Angular</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML5/">HTML5</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML5游戏/">HTML5游戏</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React-Native/">React Native</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome插件/">chrome插件</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css动画/">css动画</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http2/">http2</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/https/">https</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios/">ios</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rem/">rem</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/requirejs/">requirejs</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/svg/">svg</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wordpress/">wordpress</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/下拉刷新/">下拉刷新</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/全屏滚动/">全屏滚动</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博客搬家/">博客搬家</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能优化/">性能优化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/手势解锁/">手势解锁</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构/">数据结构</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器/">浏览器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/滚动/">滚动</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/离线存储/">离线存储</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动web/">移动web</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/视频直播/">视频直播</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试/">面试</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    
    <div class="widget tagcloud">
      <h3 class="widget-title-l">标签云</h3>
      <a href="/tags/Angular/" style="font-size: 10px;">Angular</a> <a href="/tags/HTML5/" style="font-size: 20px;">HTML5</a> <a href="/tags/HTML5游戏/" style="font-size: 10px;">HTML5游戏</a> <a href="/tags/React-Native/" style="font-size: 16.67px;">React Native</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/chrome插件/" style="font-size: 13.33px;">chrome插件</a> <a href="/tags/css动画/" style="font-size: 10px;">css动画</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/http2/" style="font-size: 16.67px;">http2</a> <a href="/tags/https/" style="font-size: 13.33px;">https</a> <a href="/tags/ios/" style="font-size: 10px;">ios</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/tags/rem/" style="font-size: 10px;">rem</a> <a href="/tags/requirejs/" style="font-size: 13.33px;">requirejs</a> <a href="/tags/svg/" style="font-size: 10px;">svg</a> <a href="/tags/wordpress/" style="font-size: 10px;">wordpress</a> <a href="/tags/下拉刷新/" style="font-size: 10px;">下拉刷新</a> <a href="/tags/全屏滚动/" style="font-size: 10px;">全屏滚动</a> <a href="/tags/博客搬家/" style="font-size: 10px;">博客搬家</a> <a href="/tags/工具/" style="font-size: 10px;">工具</a> <a href="/tags/性能优化/" style="font-size: 10px;">性能优化</a> <a href="/tags/手势解锁/" style="font-size: 10px;">手势解锁</a> <a href="/tags/数据结构/" style="font-size: 10px;">数据结构</a> <a href="/tags/浏览器/" style="font-size: 10px;">浏览器</a> <a href="/tags/滚动/" style="font-size: 10px;">滚动</a> <a href="/tags/离线存储/" style="font-size: 10px;">离线存储</a> <a href="/tags/移动web/" style="font-size: 20px;">移动web</a> <a href="/tags/视频直播/" style="font-size: 10px;">视频直播</a> <a href="/tags/面试/" style="font-size: 10px;">面试</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    
    <div class="widget">
      <h3 class="widget-title-l">友情链接</h3>
      <ul>
        
          <li>
            <a href="http://blog.csdn.net/u012844719" target="_blank">csdn博客</a>
          </li>
        
          <li>
            <a href="http://demonc.com/" target="_blank">前端Demon</a>
          </li>
        
          <li>
            <a href="http://www.dglives.com/" target="_blank">数字生活|前端</a>
          </li>
        
          <li>
            <a href="http://www.moonwen.com/" target="_blank">春熙路</a>
          </li>
        
          <li>
            <a href="http://makaiqian.com/" target="_blank">麻凯倩前端</a>
          </li>
        
          <li>
            <a href="http://jeffjade.com/" target="_blank">晚晴幽草轩</a>
          </li>
        
          <li>
            <a href="http://www.cnblogs.com/vajoy" target="_blank">Vajoy</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 John Doe<br>
      Powered by <a href="//hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>

</footer>
  </div>
  <nav style="display:none;" id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">文章归档</a>
  
    <a href="/about" class="mobile-nav-link">关于本站</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/script.js"></script>
<script src="https://cdn1.lncld.net/static/js/av-min-1.2.1.js"></script>
<script>AV.init({appId:"yqwM1H3ohsqaUqxBa2balXfY-gzGzoHsz", appKey:"gE3VrJwiTB3lfORQlaUvi2RO"});</script>
<script>
function showCount (Counter){
  var query=new AV.Query(Counter);
  query.find({
    success: function(results){

            for(var i=0;i<results.length;i++)    
            {
                var counter=results[i];
                var url=counter.get("url");
                var time=counter.get("time");
                // add to the popularlist widget
                // showcontent=title+" ("+time+")";
                //notice the "" in href
                try {
                  $('#'+url+'learnCount').text(time);
                }catch(e){}
                
            }
        },
    error: function(error){
        console.log(error);
        // alert("Error:"+error.code+" "+error.message);
    }
  });
}
function addCount (Counter) {
    
    var url=window.location.pathname.replace(/\//g,'').replace('.','').trim();
    var title = $('.article-title').text().trim();
    var query=new AV.Query(Counter);

    query.equalTo("url",url);
    query.find({
        success: function(results){
            if(results.length>0)
            {

                var counter=results[0];

                counter.fetchWhenSave(true);
                counter.increment("time");

                counter.save();

                $('#'+url+'learnCount').text(counter.get("time"));
            }
            else
            {
                var newcounter=new Counter();

                newcounter.set("title",title);
                newcounter.set("url",url);
                newcounter.set("time",1);

                newcounter.save();
            }
        },
        error: function(error){
          console.log(error);
            // alert('Error:'+error.code+" "+error.message);
        }
    });
}
var Counter=AV.Object.extend("Counter2");
if (window.location.href.indexOf('index.php/archives') > -1) {
    addCount(Counter);
} else {
    showCount(Counter);
}
</script>


</div>
</body>
</html>
