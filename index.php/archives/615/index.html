
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>H5视频直播扫盲 | 吕小鸣前端博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="视频直播这么火，再不学就out了。 为了紧跟潮流，本文将向大家介绍一下视频直播中的基本流程和主要的技术点，包括但不限于前端技术。 1 H5到底能不能做视频直播？当然可以， H5火了这么久，涵盖了各个方面的技术。">
<meta name="keywords" content="HTML5,视频直播">
<meta property="og:type" content="article">
<meta property="og:title" content="H5视频直播扫盲">
<meta property="og:url" content="http://www.nihaoshijie.com.cn/index.php/archives/615/index.html">
<meta property="og:site_name" content="吕小鸣前端博客">
<meta property="og:description" content="视频直播这么火，再不学就out了。 为了紧跟潮流，本文将向大家介绍一下视频直播中的基本流程和主要的技术点，包括但不限于前端技术。 1 H5到底能不能做视频直播？当然可以， H5火了这么久，涵盖了各个方面的技术。">
<meta property="og:image" content="https://oc5n93kni.qnssl.com/1-1604251R0335K.jpg">
<meta property="og:updated_time" content="2017-05-16T02:42:23.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="H5视频直播扫盲">
<meta name="twitter:description" content="视频直播这么火，再不学就out了。 为了紧跟潮流，本文将向大家介绍一下视频直播中的基本流程和主要的技术点，包括但不限于前端技术。 1 H5到底能不能做视频直播？当然可以， H5火了这么久，涵盖了各个方面的技术。">
<meta name="twitter:image" content="https://oc5n93kni.qnssl.com/1-1604251R0335K.jpg">
  
    <link rel="alternative" href="/atom.xml" title="吕小鸣前端博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  



</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">吕小鸣前端博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">热爱前端，关注前端开发技术</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">主页</a>
        
          <a class="main-nav-link" href="/archives">文章归档</a>
        
          <a class="main-nav-link" href="/about">关于本站</a>
        
          <a class="main-nav-link" href="/exercise">练习</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="www.nihaoshijie.com.cn">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-H5视频直播扫盲" class="article article-type-post" itemscope itemprop="blogPost">

  <div class="article-inner ">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    <div style="background-image:url(https://oc5n93kni.qnssl.com/1-1604251R0335K.jpg);" class="post-pic"></div>
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      H5视频直播扫盲
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>视频直播这么火，再不学就out了。</p>
<p>为了紧跟潮流，本文将向大家介绍一下视频直播中的基本流程和主要的技术点，包括但不限于前端技术。</p>
<p></p><h2><strong>1 H5到底能不能做视频直播？</strong></h2><br>当然可以， H5火了这么久，涵盖了各个方面的技术。<br><a id="more"></a><br>对于视频录制，可以使用强大的<span style="color: #0000cd;">webRTC</span>（Web Real-Time Communication）是一个支持网页浏览器进行实时语音对话或视频对话的技术，缺点是只在PC的chrome上支持较好，移动端支持不太理想。<p></p>
<p>对于视频播放，可以使用<span style="color: #0000cd;">HLS</span>(HTTP Live Streaming)协议播放直播流，ios和android都天然支持这种协议，配置简单，直接使用video标签即可。</p>
<p>webRTC兼容性：</p>
<p><img src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-23%2010.24.48.png" alt="" data-cke-saved-src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-23%2010.24.48.png"></p>
<p>video标签播放hls协议视频：</p>
<p><pre class="lang:default decode:true">&lt;video controls autoplay&gt;<br>    &lt;source src=”<a href="http://10.66.69.77:8080/hls/mystream.m3u8" target="_blank" rel="external">http://10.66.69.77:8080/hls/mystream.m3u8</a>“ type=”application/vnd.apple.mpegurl” /&gt;<br>    &lt;p class=”warning”&gt;Your browser does not support HTML5 video.&lt;/p&gt;<br>&lt;/video&gt;</pre></p>
<p></p><h2><strong>2 到底什么是HLS协议？</strong></h2><br>当简单讲就是把整个流分成一个个小的基于HTTP的文件来下载，每次只下载一些，前面提到了用于H5播放直播视频时引入的一个<span style="color: #0000cd;">.m3u8</span>的文件，这个文件就是基于HLS协议，存放视频流元数据的文件。<p></p>
<p>每一个.m3u8文件，分别对应若干个ts文件，这些ts文件才是真正存放视频的数据，m3u8文件只是存放了一些ts文件的配置信息和相关路径，当视频播放时，.m3u8是动态改变的，video标签会解析这个文件，并找到对应的ts文件来播放，所以一般为了加快速度，.m3u8放在web服务器上，ts文件放在cdn上。</p>
<p>.m3u8文件，其实就是以UTF-8编码的m3u文件，这个文件本身不能播放，只是存放了播放信息的文本文件：</p>
<p><pre>​#EXTM3U                     m3u文件头</pre></p>
<p>#EXT-X-MEDIA-SEQUENCE       第一个TS分片的序列号</p>
<p>#EXT-X-TARGETDURATION       每个分片TS的最大的时长</p>
<p>#EXT-X-ALLOW-CACHE          是否允许cache</p>
<p>#EXT-X-ENDLIST              m3u8文件结束符</p>
<p>#EXTINF                     指定每个媒体段(ts)的持续时间（秒），仅对其后面的URI有效<br>mystream-12.ts<br>ts文件：</p>
<p><img src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-23%2011.09.29.png" alt="" data-cke-saved-src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-23%2011.09.29.png"></p>
<p>HLS的请求流程是：<br><strong>1 http请求m3u8的url<br>2 服务端返回一个m3u8的播放列表，这个播放列表是实时跟新的，一般一次给出3段数据的url<br>3 客户端解析m3u8的播放列表，再按序请求每一段的url，获取ts数据流</strong></p>
<p>简单流程：</p>
<p><img src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-23%2011.20.29.png" alt="" data-cke-saved-src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-23%2011.20.29.png"></p>
<p></p><h2><strong>3 HLS直播延时</strong></h2><br>当我们知道hls协议是将直播流分成一段一段的小段视频去下载播放的，所以假设列表里面的包含5个TS文件，每个TS文件包含5秒的视频内容，那么整体的延迟就是25秒。因为当你看到这些视频时，主播已经将视频录制好上传上去了，所以时这样产生的延迟。当然可以缩短列表的长度和单个TS文件的大小来降低延迟，极致来说可以缩减列表长度为1，并且TS的时长为1s，但是这样会造成请求次数增加，增大服务器压力，当网速慢时回造成更多的缓冲，所以苹果官方推荐的ts时长时10s，所以这样就会大改有30s的延迟。参考资料：<a href="https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/StreamingMediaGuide/FrequentlyAskedQuestions/FrequentlyAskedQuestions.html" data-cke-saved-href="https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/StreamingMediaGuide/FrequentlyAskedQuestions/FrequentlyAskedQuestions.html" target="_blank" rel="external">https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/StreamingMediaGuide/FrequentlyAskedQuestions/FrequentlyAskedQuestions.html</a><p></p>
<p></p><h2><strong>4 视频直播的整个流程是什么？</strong></h2><br>当视频直播可大致分为：<p></p>
<p><strong>1 视频录制端：一般是电脑上的音视频输入设备或者手机端的摄像头或者麦克风，目前已移动端的手机视频为主。</strong></p>
<p><strong>2 视频播放端：可以是电脑上的播放器，手机端的native播放器，还有就是h5的video标签等，目前还是已手机端的native播放器为主。</strong></p>
<p><strong>3 视频服务器端：一般是一台nginx服务器，用来接受视频录制端提供的视频源，同时提供给视频播放端流服务。</strong></p>
<p>简单流程：</p>
<p><img src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-23%2011.33.20.png" alt="" data-cke-saved-src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-23%2011.33.20.png"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p></p><h2><strong>5 怎样进行音视频采集？</strong></h2><br>当首先明确几个概念：<p></p>
<p><strong>视频编码：所谓视频编码就是指通过特定的压缩技术，将某个视频格式的文件转换成另一种视频格式文件的方式，我们使用的iphone录制的视频，必须要经过编码，上传，解码，才能真正的在用户端的播放器里播放。</strong></p>
<p><strong>编解码标准：视频流传输中最为重要的编解码标准有国际电联的H.261、H.263、H.264，其中HLS协议支持<span style="color: #0000cd;">H.264</span>格式的编码。<br>音频编码：同视频编码类似，将原始的音频流按照一定的标准进行编码，上传，解码，同时在播放器里播放，当然音频也有许多编码标准，例如PCM编码，WMA编码，AAC编码等等，这里我们HLS协议支持的音频编码方式是<span style="color: #0000cd;">AAC编码</span>。</strong></p>
<p>下面将利用ios上的摄像头，进行音视频的数据采集，主要分为以下几个步骤：</p>
<p>&nbsp;</p>
<p><strong>1 音视频的采集，ios中，利用<span style="color: #0000cd;">AVCaptureSession</span>和<span style="color: #0000cd;">AVCaptureDevice</span>可以采集到原始的音视频数据流。<br>2 对视频进行H264编码，对音频进行AAC编码，在ios中分别有已经封装好的编码库来实现对音视频的编码。<br>3 对编码后的音、视频数据进行组装封包；<br>4 建立<span style="color: #0000cd;">RTMP</span>连接并上推到服务端。</strong></p>
<p>&nbsp;</p>
<p>ps：由于编码库大多使用c语言编写，需要自己使用时编译，对于ios，可以使用已经编译好的编码库。</p>
<p>x264编码：<a href="https://github.com/kewlbear/x264-ios" data-cke-saved-href="https://github.com/kewlbear/x264-ios" target="_blank" rel="external">https://github.com/kewlbear/x264-ios</a></p>
<p>faac编码：<a href="https://github.com/fflydev/faac-ios-build" data-cke-saved-href="https://github.com/fflydev/faac-ios-build" target="_blank" rel="external">https://github.com/fflydev/faac-ios-build</a></p>
<p>ffmpeg编码：<a href="https://github.com/kewlbear/FFmpeg-iOS-build-script" data-cke-saved-href="https://github.com/kewlbear/FFmpeg-iOS-build-script" target="_blank" rel="external">https://github.com/kewlbear/FFmpeg-iOS-build-script</a></p>
<p>关于如果想给视频增加一些特殊效果，例如增加滤镜等，一般在编码前给使用滤镜库，但是这样也会造成一些耗时，导致上传视频数据有一定延时。</p>
<p>简单流程：</p>
<p><img src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-23%2012.07.49.png" alt="" data-cke-saved-src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-23%2012.07.49.png"></p>
<p></p><h2><strong>6 前面提到的ffmpeg是什么？</strong></h2><br>和之前的<span style="color: #0000cd;">x264</span>一样，<span style="color: #0000cd;">ffmpeg</span>其实也是一套编码库，类似的还有Xvid，Xvid是基于MPEG4协议的编解码器，x264是基于H.264协议的编码器，ffmpeg集合了各种音频，视频编解码协议，通过设置参数可以完成基于MPEG4,H.264等协议的编解码，demo这里使用的是x264编码库。<p></p>
<p></p><h2><strong>7 什么是RTMP？</strong></h2><br>Real Time Messaging Protocol（简称 RTMP）是 Macromedia 开发的一套视频直播协议，现在属于 Adobe。和HLS一样都可以应用于视频直播，区别是RTMP基于flash无法在ios的浏览器里播放，但是实时性比HLS要好。所以一般使用这种协议来上传视频流，也就是视频流推送到服务器。<p></p>
<p>这里列举一下hls和rtmp对比：</p>
<p><img src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-25%2010.43.02.png" alt="" data-cke-saved-src="http://tenny.qiniudn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-05-25%2010.43.02.png"></p>
<p></p><h2><strong>8 推流</strong></h2><br>简所谓推流，就是将我们已经编码好的音视频数据发往视频流服务器中，一般常用的是使用rtmp推流，可以使用第三方库<strong><a href="https://github.com/ifactorylab/librtmp-iOS" data-cke-saved-href="https://github.com/ifactorylab/librtmp-iOS" target="_blank" rel="external">librtmp-iOS</a></strong>进行推流，librtmp封装了一些核心的api供使用者调用，如果觉得麻烦，可以使用现成的ios视频推流sdk，也是基于rtmp的，<a href="https://github.com/runner365/LiveVideoCoreSDK" data-cke-saved-href="https://github.com/runner365/LiveVideoCoreSDK" target="_blank" rel="external">https://github.com/runner365/LiveVideoCoreSDK</a><p></p>
<p></p><h2><strong>9 推流服务器搭建</strong></h2><br>简简单的推流服务器搭建，由于我们上传的视频流都是基于rtmp协议的，所以服务器也必须要支持rtmp才行，大概需要以下几个步骤：<p></p>
<p><strong>1 安装一台nginx服务器。</strong></p>
<p><strong>2 安装nginx的rtmp扩展，目前使用比较多的是<a href="https://github.com/arut/nginx-rtmp-module" data-cke-saved-href="https://github.com/arut/nginx-rtmp-module" target="_blank" rel="external">https://github.com/arut/nginx-rtmp-module</a></strong></p>
<p><strong>3 配置nginx的conf文件：</strong></p>
<p><pre>rtmp {  </pre></p>
<pre><code>server {  

    listen 1935;  #监听的端口

    chunk_size 4000;  


    application hls {  #rtmp推流请求路径
        live on;  
        hls on;  
        hls_path /usr/local/var/www/hls;  
        hls_fragment 5s;  
    }  
}  
</code></pre><p>}<br><strong>4 重启nginx，将rtmp的推流地址写为rtmp://ip:1935/hls/mystream，其中hls_path表示生成的.m3u8和ts文件所存放的地址，hls_fragment表示切片时长，mysteam表示一个实例，即将来要生成的文件名可以先自己随便设置一个。更多配置可以参考：<a href="https://github.com/arut/nginx-rtmp-module/wiki/" data-cke-saved-href="https://github.com/arut/nginx-rtmp-module/wiki/" target="_blank" rel="external">https://github.com/arut/nginx-rtmp-module/wiki/</a></strong></p>
<p>根据以上步骤基本上已经实现了一个支持rtmp的视频服务器了。</p>
<p></p><h2><strong>10 在html5页面进行播放直播视频？</strong></h2><br>简单来说，直接使用video标签即可播放hls协议的直播视频：<p></p>
<p><pre>&lt;video autoplay webkit-playsinline&gt;<br>    &lt;source src=”<a href="http://10.66.69.77:8080/hls/mystream.m3u8" target="_blank" rel="external">http://10.66.69.77:8080/hls/mystream.m3u8</a>“ type=”application/vnd.apple.mpegurl” /&gt;<br>    &lt;p class=”warning”&gt;Your browser does not support HTML5 video.&lt;/p&gt;<br>&lt;/video&gt;</pre><br>需要注意的是，给video标签增加webkit-playsinline属性，这个属性是为了让video视频在ios的uiwebview里面可以不全屏播放，默认ios会全屏播放视频，需要给uiwebview设置allowsInlineMediaPlayback＝YES。业界比较成熟的<a href="http://videojs.com/" data-cke-saved-href="http://videojs.com/" target="_blank" rel="external">videojs</a>，可以根据不同平台选择不同的策略，例如ios使用video标签，pc使用flash等。</p>
<p></p><h2><strong>11 坑点总结</strong></h2><br>简根据以上步骤，笔者写了一个demo，从实现ios视频录制，采集，上传，nginx服务器下发直播流，h5页面播放直播视频者一整套流程，总结出以下几点比较坑的地方：<p></p>
<p>1 在使用AVCaptureSession进行采集视频时，需要实现AVCaptureVideoDataOutputSampleBufferDelegate协议，同时在- (void)captureOutput:(AVCaptureOutput <em>)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection </em>)connection捕获到视频流，要注意的是didOutputSampleBuffer这个方法不是didDropSampleBuffer方法，后者只会触发一次，当时开始写的是didDropSampleBuffer方法，差了半天才发现方法调用错了。</p>
<p>2 在使用rtmp推流时，rmtp地址要以rtmp://开头，ip地址要写实际ip地址，不要写成localhost，同时要加上端口号，因为手机端上传时是无法识别localhost的。</p>
<p>这里后续会补充上一些坑点，有的需要贴代码，这里先列这么多。</p>
<p></p><h2><strong>12 业界支持</strong></h2><br>目前，<a href="https://www.qcloud.com/solution/video.html" data-cke-saved-href="https://www.qcloud.com/solution/video.html" target="_blank" rel="external">腾讯云</a>，百度云，阿里云都已经有了基于视频直播的解决方案，从视频录制到视频播放，推流，都有一系列的sdk可以使用，缺点就是需要收费，如果可以的话，自己实现一套也并不是难事哈。<p></p>
<p>&nbsp;</p>
<p>demo地址：<a href="https://github.com/lvming6816077/LMVideoTest/" data-cke-saved-href="http://blob/master/LMVideoTest/ViewController.m" target="_blank" rel="external">https://github.com/lvming6816077/LMVideoTest/</a></p>

      
    </div>

    <footer class="article-footer">
      
        <a data-url="http://www.nihaoshijie.com.cn/index.php/archives/615/" data-id="cj4dymsdo0008lr9nrfe7meyi" class="article-share-link" data-share="baidu" data-title="H5视频直播扫盲">分享到</a>
      

      <a href="http://www.nihaoshijie.com.cn/index.php/archives/615/#ds-thread" class="article-comment-link"><span class="dot">•</span>
      <span class="view-count" id="indexphparchives615learnCount">0</span> 次浏览</a>
      <a href="http://www.nihaoshijie.com.cn/index.php/archives/615/#ds-thread" class="article-comment-link"><span class="dot">•</span>
      
        <span class="cloud-tie-join-count"><span class="join-count">0</span></span>
      
      条评论</a>
      
      <a href="/index.php/archives/615/" class="article-date-l">
  <time datetime="2016-05-25T13:04:19.000Z" itemprop="datePublished">2016-05-25</time>
</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTML5/">HTML5</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/视频直播/">视频直播</a></li></ul>

    </footer>
  </div>
  
    
  
</article>


  <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    <script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>
    <script>
    var cloudTieConfig = {
      url: document.location.href.replace('https','').replace('http',''),
      sourceId: "",
      productKey: "eb0b276c0f00410db0322e1a9a9b8bbc",
      target: "cloud-tie-wrapper"
    };
    var yunManualLoad = true;
    Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);
    </script>

</section>
      
      <aside id="sidebar">

  <div class="widget-wrap">
    
    <div class="widget info">

      <img class="avatar" src="https://avatars3.githubusercontent.com/u/7931760?v=3&s=460"/>
      <h3 class="nick-name">吕小鸣</h3>
      <p class="desc">实践过，才懂得</p>
      <div class="post-info">
        <div class="info-inner">
          <div class="info-num">28</div>
          <div class="info-name">文章</div>
        </div>
        <div class="info-inner">
          <div class="info-num">18</div>
          <div class="info-name">分类</div>
        </div>
        <div class="info-inner">
          <div class="info-num">29</div>
          <div class="info-name">标签</div>
        </div>
      </div>
      <div class="info-links">
        <a class="info-link github" href="https://github.com/lvming6816077" target="_blank" title="GitHub">
        <i class="github"></i>
          GitHub
        </a>
        <a class="info-link weibo" href="http://weibo.com/lvming6816077/home?wvr=5&topnav=1&mod=logo" target="_blank" title="GitHub">
        <i class="weibo"></i>
          WeiBo
        </a>
      </div>
    </div>
  </div>
  
  <div class="widget-wrap">
    
    <div class="widget">
      <img style="width:100%;" src="https://oc5n93kni.qnssl.com/qunmingp.jpg" />
    </div>
  </div>
  
    
  <div class="widget-wrap">
    
    <div class="widget">
    <h3 class="widget-title-l">近期文章</h3>
      <ul>
        
          <li class="recent-li">
            <a href="/index.php/archives/700/">吕小鸣博客搬家记Hexo</a>
          </li>
        
          <li class="recent-li">
            <a href="/index.php/archives/698/">HTTP2.0关于多路复用的研究</a>
          </li>
        
          <li class="recent-li">
            <a href="/index.php/archives/690/">移动web之滚动篇</a>
          </li>
        
          <li class="recent-li">
            <a href="/index.php/archives/667/">线条之美，玩转SVG线条动画</a>
          </li>
        
          <li class="recent-li">
            <a href="/index.php/archives/651/">HTTP2 Server Push 研究</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title-l">归档</h3>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">十月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">九月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">八月 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">七月 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">六月 2014</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    
    <div class="widget">
      <h3 class="widget-title-l">标签</h3>
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Angular/">Angular</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML5/">HTML5</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML5游戏/">HTML5游戏</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React-Native/">React Native</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome插件/">chrome插件</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css动画/">css动画</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http2/">http2</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/https/">https</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios/">ios</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rem/">rem</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/requirejs/">requirejs</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/svg/">svg</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wordpress/">wordpress</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/下拉刷新/">下拉刷新</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/全屏滚动/">全屏滚动</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博客搬家/">博客搬家</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能优化/">性能优化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/手势解锁/">手势解锁</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构/">数据结构</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器/">浏览器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/滚动/">滚动</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/离线存储/">离线存储</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动web/">移动web</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/视频直播/">视频直播</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试/">面试</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    
    <div class="widget tagcloud">
      <h3 class="widget-title-l">标签云</h3>
      <a href="/tags/Angular/" style="font-size: 10px;">Angular</a> <a href="/tags/HTML5/" style="font-size: 20px;">HTML5</a> <a href="/tags/HTML5游戏/" style="font-size: 10px;">HTML5游戏</a> <a href="/tags/React-Native/" style="font-size: 16.67px;">React Native</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/chrome插件/" style="font-size: 13.33px;">chrome插件</a> <a href="/tags/css动画/" style="font-size: 10px;">css动画</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/http2/" style="font-size: 16.67px;">http2</a> <a href="/tags/https/" style="font-size: 13.33px;">https</a> <a href="/tags/ios/" style="font-size: 10px;">ios</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/tags/rem/" style="font-size: 10px;">rem</a> <a href="/tags/requirejs/" style="font-size: 13.33px;">requirejs</a> <a href="/tags/svg/" style="font-size: 10px;">svg</a> <a href="/tags/wordpress/" style="font-size: 10px;">wordpress</a> <a href="/tags/下拉刷新/" style="font-size: 10px;">下拉刷新</a> <a href="/tags/全屏滚动/" style="font-size: 10px;">全屏滚动</a> <a href="/tags/博客搬家/" style="font-size: 10px;">博客搬家</a> <a href="/tags/工具/" style="font-size: 10px;">工具</a> <a href="/tags/性能优化/" style="font-size: 10px;">性能优化</a> <a href="/tags/手势解锁/" style="font-size: 10px;">手势解锁</a> <a href="/tags/数据结构/" style="font-size: 10px;">数据结构</a> <a href="/tags/浏览器/" style="font-size: 10px;">浏览器</a> <a href="/tags/滚动/" style="font-size: 10px;">滚动</a> <a href="/tags/离线存储/" style="font-size: 10px;">离线存储</a> <a href="/tags/移动web/" style="font-size: 20px;">移动web</a> <a href="/tags/视频直播/" style="font-size: 10px;">视频直播</a> <a href="/tags/面试/" style="font-size: 10px;">面试</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    
    <div class="widget">
      <h3 class="widget-title-l">友情链接</h3>
      <ul>
        
          <li>
            <a href="http://blog.csdn.net/u012844719" target="_blank">csdn博客</a>
          </li>
        
          <li>
            <a href="http://demonc.com/" target="_blank">前端Demon</a>
          </li>
        
          <li>
            <a href="http://www.dglives.com/" target="_blank">数字生活|前端</a>
          </li>
        
          <li>
            <a href="http://www.moonwen.com/" target="_blank">春熙路</a>
          </li>
        
          <li>
            <a href="http://makaiqian.com/" target="_blank">麻凯倩前端</a>
          </li>
        
          <li>
            <a href="http://jeffjade.com/" target="_blank">晚晴幽草轩</a>
          </li>
        
          <li>
            <a href="http://www.cnblogs.com/vajoy" target="_blank">Vajoy</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 John Doe<br>
      Powered by <a href="//hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>

</footer>
  </div>
  <nav style="display:none;" id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">文章归档</a>
  
    <a href="/about" class="mobile-nav-link">关于本站</a>
  
    <a href="/exercise" class="mobile-nav-link">练习</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superman/js/lib/jquery-1.10.2_d88366fd.js"></script>




<script src="/js/script.js"></script>
<script src="https://cdn1.lncld.net/static/js/av-min-1.2.1.js"></script>
<script>AV.init({appId:"yqwM1H3ohsqaUqxBa2balXfY-gzGzoHsz", appKey:"gE3VrJwiTB3lfORQlaUvi2RO"});</script>
<script>
  var fakeCount = 500;
function showCount (Counter){
  var query=new AV.Query(Counter);

  query.find({
    success: function(results){

            for(var i=0;i<results.length;i++)    
            {
                var counter=results[i];
                var url=counter.get("url");
                var time=counter.get("time");

                try {
                  $('#'+url+'learnCount').text(parseInt(time)+fakeCount);
                }catch(e){}
                
            }
        },
    error: function(error){
        console.log(error);
        // alert("Error:"+error.code+" "+error.message);
    }
  });
}
function addCount (Counter) {
    
    var url=window.location.pathname.replace(/\//g,'').replace('.','').trim();
    var title = $('.article-title').text().trim();
    var query=new AV.Query(Counter);

    query.equalTo("url",url);
    query.find({
        success: function(results){
            if(results.length>0)
            {

                var counter=results[0];

                counter.fetchWhenSave(true);
                counter.increment("time");

                counter.save();

                $('#'+url+'learnCount').text(parseInt(counter.get("time"))+fakeCount);
            }
            else
            {
                var newcounter=new Counter();

                newcounter.set("title",title);
                newcounter.set("url",url);
                newcounter.set("time",1);

                newcounter.save();
            }
        },
        error: function(error){
          console.log(error);
            // alert('Error:'+error.code+" "+error.message);
        }
    });
}
var Counter=AV.Object.extend("Counter2");
if (window.location.href.indexOf('index.php/archives') > -1) {
    addCount(Counter);
} else {
    showCount(Counter);
}
</script>
<script>

var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?cc3b1819bb80c692fc8d2c31352da6a7";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</div>
</body>
</html>
